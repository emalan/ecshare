<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:util="http://www.springframework.org/schema/util"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
    http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
    http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.0.xsd">

    <bean id="repositoryWorkspaceAdmin" class="com.madalla.cms.service.jcr.RepositoryWorkspaceAdmin"
        init-method="init">
        <property name="workspace" value="${repository.workspace}"/>
        <property name="template" ref="defaultWorkspaceTemplate"/>
    </bean>

    <bean id="repositoryAdminService" class="com.madalla.cms.service.jcr.RepositoryAdminService">
        <property name="template" ref="jcrTemplate"/>
        <property name="site" value="${site.code}"/>
        <property name="repositoryHome" value="${repository.home}"/>
    </bean>
    
    <bean id="dataService" class="com.madalla.cms.service.ocm.RepositoryService"
        init-method="init" scope="singleton">
        <property name="template" ref="jcrTemplate"/>
        <property name="site" value="${site.code}"/>
        <property name="emailEntryDao" ref="emailEntryDao"/>
        <property name="memberDao" ref="memberDao"/>
        <property name="transactionLogDao" ref="transactionLogDao"/>
        <property name="userSecurityService" ref="userSecurityService"/>
        
    </bean>
    
    <bean id="userSecurityService" class="com.madalla.cms.service.ocm.UserSecurityService"
        scope="singleton">
        <property name="template" ref="jcrTemplate"/>
        <property name="site" value="${site.code}"/>
        <property name="transactionLogDao" ref="transactionLogDao"/>
        <property name="authenticator" ref="authenticator"/>
    </bean>    

    <bean id="authenticator" class="com.madalla.webapp.security.PasswordAuthenticator"
    	scope="singleton">
    </bean>
	
	<bean id="backupCreator" class="com.madalla.cms.service.jcr.RepositoryBackupCreator">
		<constructor-arg ref="repositoryAdminService"/>
	</bean>
	
</beans>



